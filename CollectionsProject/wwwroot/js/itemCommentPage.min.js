function PrevPage(n,t){isEnd||callBackPrev||(callBackPrev=!0,page++,$.post(n,{itemId:itemIden,Time:t,Page:page},function(n){n!==""?$("#comment-wrapper").prepend(n):isEnd=!0;callBackPrev=!1}))}function updateLike(n){if(userName!==""){let i=!1,t=$(n.target),r=t.prev(),u=t.closest(".message").attr("id");t.hasClass(liked)&&(i=!0);t.toggleClass(liked);$.post("/Comment/UpdateLike/",{commentId:u,oldLikeState:i},function(n){n!==""&&r.text(n)})}}let dateTimeSend=(new Date).toISOString();console.log(dateTimeSend);let dateTimeLoad=dateTimeSend,itemIden=$("#ItemIdentificator").val(),page=-1,isEnd=!1,callBackPrev=!1,userName=$("#Uid").val();const liked="liked";PrevPage("/Comment/PreviousPage/",dateTimeLoad);$("#comment-wrapper").scroll(function(){$("#comment-wrapper").scrollTop()<10&&PrevPage("/Comment/PreviousPage/",dateTimeLoad)});let connection=(new signalR.HubConnectionBuilder).withUrl("/CommentsHub").build();connection.start().then(function(){connection.invoke("SubscribeComment",itemIden)}).catch(function(n){return console.error(n.toString())});connection.on("GetNewComment",function(n){$.post("/Comment/GetComment/",{comment:n},function(n){n!==""&&$("#comment-wrapper").append(n)})});userName!==""&&$("#submit-btn").click(function(){let n={ItemId:itemIden,Text:$("#text-comment").val(),UserName:userName};connection.invoke("CreateComment",n).catch(function(n){return console.error(n.toString())})});